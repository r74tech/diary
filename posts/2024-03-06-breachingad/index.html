<!doctype html><html lang="ja" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="[wip] Breaching Active Directory" /><meta name="author" content="r74tech" /><meta property="og:locale" content="ja" /><meta name="description" content="邦訳: Active Directoryへの侵入" /><meta property="og:description" content="邦訳: Active Directoryへの侵入" /><link rel="canonical" href="https://blog.r74tech.com/posts/2024-03-06-breachingad/" /><meta property="og:url" content="https://blog.r74tech.com/posts/2024-03-06-breachingad/" /><meta property="og:site_name" content="R74" /><meta property="og:image" content="https://blog.r74tech.com/assets/img/og/2024-03-06-breachingad.png?r=1744624598002" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-03-06T00:00:00+09:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://blog.r74tech.com/assets/img/og/2024-03-06-breachingad.png?r=1744624598002" /><meta property="twitter:title" content="[wip] Breaching Active Directory" /><meta name="twitter:site" content="@r74tech" /><meta name="twitter:creator" content="@r74tech" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"r74tech","url":"https://twitter.com/r74tech"},"dateModified":"2024-06-06T01:44:21+09:00","datePublished":"2024-03-06T00:00:00+09:00","description":"邦訳: Active Directoryへの侵入","headline":"[wip] Breaching Active Directory","image":{"show":false,"url":"https://blog.r74tech.com/assets/img/og/2024-03-06-breachingad.png?r=1744624598002","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.r74tech.com/posts/2024-03-06-breachingad/"},"url":"https://blog.r74tech.com/posts/2024-03-06-breachingad/"}</script><title>[wip] Breaching Active Directory | R74</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="R74"><meta name="application-name" content="R74"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="preconnect" href="https://cdnjs.cloudflare.com" ><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&family=M+PLUS+1p&family=Noto+Sans+JP:wght@100..900&family=Arimo:ital,wght@0,400..700;1,400..700&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/favicons/image.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">R74</a></h1><p class="site-subtitle fst-italic mb-0">r74's tech blog</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/certifications/" class="nav-link"> <i class="fa-fw fas fa-certificate"></i> <span>CERTIFICATIONS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/r74tech" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/r74tech" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['r74tech','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>[wip] Breaching Active Directory</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>[wip] Breaching Active Directory</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1709650800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 6, 2024 </time> </span> <span> Updated <time data-ts="1717605861" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 6, 2024 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/r74tech">r74tech</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1283 words" > <em>7 min</em> read</span></div></div></div></header><div class="content"><h2 id="邦訳-active-directoryへの侵入"><span class="me-2">邦訳: Active Directoryへの侵入</span><a href="#邦訳-active-directoryへの侵入" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>ADの設定ミスをついて特権昇格や横断的移動、目的実行などを行うにはまず、初期アクセスが必要となる。</p><p>このRoomでは、ADに侵入するための方法をいくつか紹介する。</p><ul><li>NTLM認証サービス<li>LDAPバインド資格情報<li>認証リレー<li>Microsoft Deployment Toolkit<li>設定ファイル</ul><hr /><h2 id="task-1-introduction-to-ad-breaches"><span class="me-2">Task 1: Introduction to AD Breaches</span><a href="#task-1-introduction-to-ad-breaches" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>まずは、ネットワーク内の特定のサーバーやリソースにアクセスするために必要な名前解決を行う設定から始める。これにより、ドメイン名をIPアドレスに変換し、ネットワーク通信の正しいルーティングを確保する。</p><p><a href="/assets/img/post/2024-03-06/Untitled.png" class="popup img-link shimmer"><img src="/assets/img/post/2024-03-06/Untitled.png" alt="Untitled" loading="lazy"></a></p><p>下記のコマンドは、この名前解決プロセスを設定するために使用され、<code class="language-plaintext highlighter-rouge">THMDCIP</code>変数には、TryHackMeのドメインコントローラーのIPアドレスが格納され、このアドレスがDNSサーバーとして機能する。これにより、<code class="language-plaintext highlighter-rouge">za.tryhackme.com</code>ドメイン内のホストに対するクエリが正確に解決され、タスクやチャレンジに必要なネットワークリソースへのアクセスが可能になる。</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ THMDCIP</span><span class="o">=</span>10.200.28.101
<span class="nv">$ </span>systemd-resolve <span class="nt">--interface</span> breachad <span class="nt">--set-dns</span> <span class="nv">$THMDCIP</span> <span class="nt">--set-domain</span> za.tryhackme.com
</pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th>コマンド部分<th>説明<tbody><tr><td>systemd-resolve<td>DNS設定やクエリ実行に関するコマンドラインツール<tr><td>–interface breachad<td>操作を適用するネットワークインターフェースを指定<tr><td>–set-dns $THMDCIP<td>使用するDNSサーバーのIPアドレスを設定<tr><td>–set-domain za.tryhackme.com<td>検索ドメインを設定</table></div><p>※ 検索ドメイン: FQDNではないホスト名に対して自動的に追加されるドメイン。</p><ul><li>I have completed the AD basics room and am ready to learn about AD breaching techniques.<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>No answer needed
</pre></table></code></div></div><li>I have connected to the network and configured DNS.<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>No answer needed
</pre></table></code></div></div></ul><h2 id="task2osint-and-phishing"><span class="me-2">Task2: OSINT and Phishing</span><a href="#task2osint-and-phishing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>I understand OSINT and how it can be used to breach AD(ADを侵害するために使用できるOSINTを理解している)<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>No answer needed
</pre></table></code></div></div><li>I understand Phishing and how it can be used to breach AD(ADを侵害するために使用できるフィッシングを理解している)<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>No answer needed
</pre></table></code></div></div><li>What popular website can be used to verify if your email address or password has ever been exposed in a publicly disclosed data breach? (自分のメールアドレスやパスワードが、一般に公開されたデータ流出事件で流出したことがあるかどうかを確認するために、人気のあるウェブサイトはなんだろうか？)<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>HaveIBeenPwned
</pre></table></code></div></div></ul><h2 id="task-3-ntlm-authenticated-services"><span class="me-2">Task 3: NTLM Authenticated Services</span><a href="#task-3-ntlm-authenticated-services" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>What is the name of the challenge-response authentication mechanism that uses NTLM?(NTLMを使用したチャレンジ-レスポンス認証メカニズムの名前は何か？)<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>NetNtlm
</pre></table></code></div></div><li>What is the username of the third valid credential pair found by the password spraying script?(パスワードスプレーのスクリプトで見つかった3番目の有効な資格情報のユーザー名は何か？)<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gordon.stevens
</pre></table></code></div></div><li>How many valid credentials pairs were found by the password spraying script?(パスワードスプレーのスクリプトで見つかった有効な資格情報のペアは何組か？)<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>4
</pre></table></code></div></div><li>What is the message displayed by the web application when authenticating with a valid credential pair?(有効な資格情報のペアで認証すると、<a href="http://ntlmauth.za.tryhackme.com">Webアプリケーション</a>に表示されるメッセージは何か？)<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Hello World
</pre></table></code></div></div></ul><h2 id="task-4-ldap-bind-credentials"><span class="me-2">Task 4: LDAP Bind Credentials</span><a href="#task-4-ldap-bind-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>What type of attack can be performed against LDAP Authentication systems not commonly found against Windows Authentication systems?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>LDAP Pass-back Attack
</pre></table></code></div></div><li>What two authentication mechanisms do we allow on our rogue LDAP server to downgrade the authentication and make it clear text?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>LOGIN,PLAIN
</pre></table></code></div></div><li>What is the password associated with the svcLDAP account?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tryhackmeldappass1@
</pre></table></code></div></div></ul><h2 id="task-5-authentication-relay"><span class="me-2">Task 5: Authentication Relay</span><a href="#task-5-authentication-relay" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>What is the name of the tool we can use to poison and capture authentication requests on the network?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Responder
</pre></table></code></div></div><li>What is the username associated with the challenge that was captured?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>svcFileCopy
</pre></table></code></div></div><li>What is the value of the cracked password associated with the challenge that was captured?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>FPassword1!
</pre></table></code></div></div></ul><h2 id="task-6-microsoft-deployment-toolkit"><span class="me-2">Task 6: Microsoft Deployment Toolkit</span><a href="#task-6-microsoft-deployment-toolkit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>What Microsoft tool is used to create and host PXE Boot images in organisations?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Microsoft Deployment Toolkit
</pre></table></code></div></div><li>What network protocol is used for recovery of files from the MDT server?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TFTP
</pre></table></code></div></div><li>What is the username associated with the account that was stored in the PXE Boot image?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>svcMDT
</pre></table></code></div></div><li>What is the password associated with the account that was stored in the PXE Boot image?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>PXEBootSecure1@
</pre></table></code></div></div><li>While you should make sure to cleanup you user directory that you created at the start of the task, if you try you will notice that you get an access denied error. Don’t worry, a script will help with the cleanup process but remember when you are doing assessments to always perform cleanup.<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>No answer needed
</pre></table></code></div></div></ul><h2 id="task-7-configuration-files"><span class="me-2">Task 7: Configuration Files</span><a href="#task-7-configuration-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>What type of files often contain stored credentials on hosts?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Configuration Files
</pre></table></code></div></div><li>What is the name of the McAfee database that stores configuration including credentials used to connect to the orchestrator?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ma.db
</pre></table></code></div></div><li>What table in this database stores the credentials of the orchestrator?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>AGENT_REPOSITORIES
</pre></table></code></div></div><li>What is the username of the AD account associated with the McAfee service?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>svcAV
</pre></table></code></div></div><li>What is the password of the AD account associated with the McAfee service?<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>MyStrongPassword!
</pre></table></code></div></div></ul><h2 id="task-8-conclusion"><span class="me-2">Task 8: Conclusion</span><a href="#task-8-conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>I understand how configuration changes can help prevent AD breaches.<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>No answer needed
</pre></table></code></div></div></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/wip/">wip</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/active-directory/" class="post-tag no-text-decoration">Active Directory</a> <a href="/tags/tryhackme/" class="post-tag no-text-decoration">tryhackme</a> <a href="/tags/wip/" class="post-tag no-text-decoration">wip</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 "><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/"> CC BY-SA 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[wip]%20Breaching%20Active%20Directory%20-%20R74&url=https%3A%2F%2Fblog.r74tech.com%2Fposts%2F2024-03-06-breachingad%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[wip]%20Breaching%20Active%20Directory%20-%20R74&u=https%3A%2F%2Fblog.r74tech.com%2Fposts%2F2024-03-06-breachingad%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fblog.r74tech.com%2Fposts%2F2024-03-06-breachingad%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="https://b.hatena.ne.jp/add?mode=confirm&url=https%3A%2F%2Fblog.r74tech.com%2Fposts%2F2024-03-06-breachingad%2F&title=[wip]%20Breaching%20Active%20Directory%20-%20R74" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="はてなブックマーク" aria-label="はてなブックマーク"> <i class="fa-fw fab fa-hatena"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/2025-04-08-takumi/">セキュリティ診断AIエージェント「Takumi」世界最速体験会 参加レポート</a><li class="text-truncate lh-lg"> <a href="/posts/2025-03-23-crtp-certification-experience/">CRTP (Certified Red Team Professional) Certification Experience</a><li class="text-truncate lh-lg"> <a href="/posts/2024-12-19-aozora-duckdb/">DuckDBとCodeMirrorを使って青空文庫のデータを検索する</a><li class="text-truncate lh-lg"> <a href="/posts/2024-07-18-rust-quinn-test/">QuinnでQUICを試す</a><li class="text-truncate lh-lg"> <a href="/posts/2024-09-21-azasecjaws01/">[wip] とある海豹とSecurity-JAWS #01 Writeup</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/wip/">wip</a> <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">Active Directory</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">Security</a> <a class="post-tag btn btn-outline-primary" href="/tags/writeup/">writeup</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai/">AI</a> <a class="post-tag btn btn-outline-primary" href="/tags/crtp/">CRTP</a> <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">ctf</a> <a class="post-tag btn btn-outline-primary" href="/tags/django/">django</a> <a class="post-tag btn btn-outline-primary" href="/tags/duckdb/">duckdb</a> <a class="post-tag btn btn-outline-primary" href="/tags/front/">front</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/2024-06-05-active-directory-1-adds/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1717513200" data-df="ll" > Jun 5, 2024 </time><h4 class="pt-0 my-2">[wip] Active Directoryの構築 1 (ADDS編)</h4><div class="text-muted"><p> ADDS構築 0. 事前準備 ホスト名をADDCに変更する 1 Rename-Computer -NewName &quot;ADDC&quot; IPアドレスを192.168.10.100に変更する 1 Get-NetIPAddress | New-NetIPAddress -AddressFamily IPv4 -IPAddress 192.168.10.100 ...</p></div></div></a></article><article class="col"> <a href="/posts/2024-06-05-active-directory-2-adcs/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1717513200" data-df="ll" > Jun 5, 2024 </time><h4 class="pt-0 my-2">[wip] Active Directoryの構築 2 (ADCS編)</h4><div class="text-muted"><p> ADCS構築 0. ADCSをADに参加させる ADDSの操作 サーバーマネージャーの「ツール」&amp;gt;「Active Directory ユーザーとコンピューター」をクリックする AD用のOUを右クリックし、「新規作成」&amp;gt;「ユーザー」をクリックする ADCS用のユーザーを作成する ここでは、adcsというユーザーを作成す...</p></div></div></a></article><article class="col"> <a href="/posts/2024-06-06-acrive-directory-3-adfs/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1717599600" data-df="ll" > Jun 6, 2024 </time><h4 class="pt-0 my-2">[wip] Active Directoryの構築 3 (ADFS 前編)</h4><div class="text-muted"><p> AD FS構築 0. AD FSの準備 AD FS用のアカウントと、AD FS用のサービスアカウントを作成する AD DS, AD CSの時と同じように、AD FS用のユーザーを作成する ここでは、adfsというユーザーを作成する adfsユーザーを右クリックし、「プロパティ」をクリックして、「所属するグループ」タブをクリックする ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/2024-02-29-generate-og/" class="btn btn-outline-primary" aria-label="Older" ><p>OG画像を動的に生成する</p></a> <a href="/posts/2024-03-21-shibboleth-nginx-django/" class="btn btn-outline-primary" aria-label="Newer" ><p>[wip] NginxとDjangoでShibboleth認証を実装する</p></a></nav><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'r74tech/diary', 'data-repo-id': 'R_kgDOLYxsXQ', 'data-category': 'Announcements', 'data-category-id': 'DIC_kwDOLYxsXc4Cf4fq', 'data-mapping': 'pathname', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': 'en', 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/r74tech">r74tech</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution-ShareAlike 4.0 (CC BY-SA 4.0) License by the author." >Some rights reserved.</span></p><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/wip/">wip</a> <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">Active Directory</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">Security</a> <a class="post-tag btn btn-outline-primary" href="/tags/writeup/">writeup</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai/">AI</a> <a class="post-tag btn btn-outline-primary" href="/tags/crtp/">CRTP</a> <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">ctf</a> <a class="post-tag btn btn-outline-primary" href="/tags/django/">django</a> <a class="post-tag btn btn-outline-primary" href="/tags/duckdb/">duckdb</a> <a class="post-tag btn btn-outline-primary" href="/tags/front/">front</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/ja.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-M25T2W3P17"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-M25T2W3P17'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
