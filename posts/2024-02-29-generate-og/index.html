<!doctype html><html lang="ja" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="OG画像を動的に生成する" /><meta name="author" content="r74tech" /><meta property="og:locale" content="ja" /><meta name="description" content="Twitter で見かける、技術系記事を自サイトでホストしている人達は華やかな OG 画像を載せている。実際、リンクを共有したときに表示されるのであれば記事の内容が一目でわかる。" /><meta property="og:description" content="Twitter で見かける、技術系記事を自サイトでホストしている人達は華やかな OG 画像を載せている。実際、リンクを共有したときに表示されるのであれば記事の内容が一目でわかる。" /><link rel="canonical" href="https://blog.r74tech.com/posts/2024-02-29-generate-og/" /><meta property="og:url" content="https://blog.r74tech.com/posts/2024-02-29-generate-og/" /><meta property="og:site_name" content="R74" /><meta property="og:image" content="https://blog.r74tech.com/assets/img/og/2024-02-29-generate-og.png?r=1744624597994" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-02-29T00:00:00+09:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://blog.r74tech.com/assets/img/og/2024-02-29-generate-og.png?r=1744624597994" /><meta property="twitter:title" content="OG画像を動的に生成する" /><meta name="twitter:site" content="@r74tech" /><meta name="twitter:creator" content="@r74tech" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"r74tech","url":"https://twitter.com/r74tech"},"dateModified":"2024-06-07T02:13:08+09:00","datePublished":"2024-02-29T00:00:00+09:00","description":"Twitter で見かける、技術系記事を自サイトでホストしている人達は華やかな OG 画像を載せている。実際、リンクを共有したときに表示されるのであれば記事の内容が一目でわかる。","headline":"OG画像を動的に生成する","image":{"show":false,"url":"https://blog.r74tech.com/assets/img/og/2024-02-29-generate-og.png?r=1744624597994","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.r74tech.com/posts/2024-02-29-generate-og/"},"url":"https://blog.r74tech.com/posts/2024-02-29-generate-og/"}</script><title>OG画像を動的に生成する | R74</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="R74"><meta name="application-name" content="R74"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="preconnect" href="https://cdnjs.cloudflare.com" ><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&family=M+PLUS+1p&family=Noto+Sans+JP:wght@100..900&family=Arimo:ital,wght@0,400..700;1,400..700&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/favicons/image.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">R74</a></h1><p class="site-subtitle fst-italic mb-0">r74's tech blog</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/certifications/" class="nav-link"> <i class="fa-fw fas fa-certificate"></i> <span>CERTIFICATIONS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/r74tech" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/r74tech" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['r74tech','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>OG画像を動的に生成する</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>OG画像を動的に生成する</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1709132400" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 29, 2024 </time> </span> <span> Updated <time data-ts="1717693988" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 7, 2024 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/r74tech">r74tech</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="864 words" > <em>4 min</em> read</span></div></div></div></header><div class="content"><p>Twitter で見かける、技術系記事を自サイトでホストしている人達は華やかな OG 画像を載せている。実際、リンクを共有したときに表示されるのであれば記事の内容が一目でわかる。</p><p>このサイトは Jekyll で生成しており、Github Actions+Ruby で OG 画像を生成するとデプロイに非常に時間がかかるため、<a href="https://www.npmjs.com/package/satori"><code class="language-plaintext highlighter-rouge">satori</code></a>と<a href="https://github.com/yisibl/resvg-js"><code class="language-plaintext highlighter-rouge">@resvg/resvg-js</code></a>を用いて OG 画像を生成する方法を考えた。</p><h2 id="環境"><span class="me-2">環境</span><a href="#環境" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>@resvg/resvg-js 2.6.0
gray-matter 4.0.3
satori 0.10.13
satori-html 0.3.2
</pre></table></code></div></div><h2 id="実装"><span class="me-2">実装</span><a href="#実装" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>markdown ファイルは以下のように、frontmatter を事前に設定しておく。</p><div class="language-md highlighter-rouge"><div class="code-header"> <span data-label-text="Markdown"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nn">---</span>
<span class="na">title</span><span class="pi">:</span> <span class="s">sample</span>
<span class="na">slug</span><span class="pi">:</span> <span class="s">2024-02-29-sample</span>
<span class="na">tags</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">sample</span>
  <span class="pi">-</span> <span class="s">test</span>
<span class="nn">---</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">slug</code> は記事の URL になる他、OG 画像のファイル名にもなる。また、<code class="language-plaintext highlighter-rouge">tags</code> は OG 画像の説明に使う。</p><p>以下のスクリプトは、<code class="language-plaintext highlighter-rouge">\_posts</code> ディレクトリにあるファイルを読み込み、frontmatter を元に OG 画像を生成する。</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">readdir</span><span class="p">,</span> <span class="nx">readFile</span><span class="p">,</span> <span class="nx">writeFile</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">fs/promises</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">join</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">path</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">matter</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">gray-matter</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Resvg</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@resvg/resvg-js</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">html</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">satori-html</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">satori</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">satori</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">dir</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">./_posts</span><span class="dl">"</span><span class="p">;</span>
<span class="k">try</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">files</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">readdir</span><span class="p">(</span><span class="nx">dir</span><span class="p">);</span>
  <span class="k">for </span><span class="p">(</span><span class="kd">const</span> <span class="nx">file</span> <span class="k">of</span> <span class="nx">files</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">readFile</span><span class="p">(</span><span class="nf">join</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">file</span><span class="p">),</span> <span class="dl">"</span><span class="s2">utf8</span><span class="dl">"</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nf">matter</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
    <span class="k">await</span> <span class="nf">generateOgImage</span><span class="p">({</span>
      <span class="na">title</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span>
      <span class="na">slug</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">slug</span><span class="p">.</span><span class="nf">toLowerCase</span><span class="p">(),</span>
      <span class="na">description</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">tags</span> <span class="p">?</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">tags</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="dl">"</span><span class="s2">, </span><span class="dl">"</span><span class="p">)</span> <span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Error:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nf">generateOgImage</span><span class="p">({</span> <span class="nx">title</span><span class="p">,</span> <span class="nx">slug</span><span class="p">,</span> <span class="nx">description</span> <span class="p">})</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">satori</span><span class="p">(</span>
    <span class="nx">html</span><span class="s2">` &lt;style&gt;
        div {
          display: flex;
        }

        .wrapper {
          display: flex;
          flex-direction: column;
          background-color: #0f0d0e;
          height: 630px;
          padding: 80px;
        }

        .top {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .bottom {
          display: flex;
          flex-direction: column;
          justify-content: flex-end;
          flex-basis: 100%;
          width: 90%;
          padding-bottom: 40px;
        }

        .install {
          font-size: 32px;
          font-family: "Fira Code";
          color: #f9f4da;
        }

        .install span {
          color: #0ba95b;
          padding-right: 16px;
        }

        .title {
          margin-top: 16px;
          font-size: 64px;
          font-family: "Zen Kaku Gothic New";
          font-weight: 400;
          color: #12b5e5;
          word-break: auto-phrase;
        }

        .description {
          margin-top: 16px;
          font-family: "Outfit";
          font-size: 40px;
          font-weight: 400;
          color: #f9f4da;
        }
      &lt;/style&gt;
      &lt;div class="wrapper"&gt;
        &lt;div class="top"&gt;
          &lt;div class="install"&gt;&lt;span&gt;&gt;&lt;/span&gt; pnpm i @r74tech/blog&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="bottom"&gt;
          &lt;div class="title"&gt;</span><span class="p">${</span><span class="nx">title</span><span class="p">}</span><span class="s2">&lt;/div&gt;
          &lt;div class="description"&gt;</span><span class="p">${</span><span class="nx">description</span><span class="p">}</span><span class="s2">&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;`</span><span class="p">,</span>
    <span class="p">{</span>
      <span class="na">fonts</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Outfit</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">data</span><span class="p">:</span> <span class="k">await</span> <span class="nf">readFile</span><span class="p">(</span>
            <span class="k">new</span> <span class="nc">URL</span><span class="p">(</span><span class="dl">"</span><span class="s2">./assets/fonts/outfit-regular.ttf</span><span class="dl">"</span><span class="p">,</span> <span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span>
          <span class="p">),</span>
          <span class="na">weight</span><span class="p">:</span> <span class="dl">"</span><span class="s2">400</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">style</span><span class="p">:</span> <span class="dl">"</span><span class="s2">normal</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Fira Code</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">data</span><span class="p">:</span> <span class="k">await</span> <span class="nf">readFile</span><span class="p">(</span>
            <span class="k">new</span> <span class="nc">URL</span><span class="p">(</span><span class="dl">"</span><span class="s2">./assets/fonts/firacode-regular.ttf</span><span class="dl">"</span><span class="p">,</span> <span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span>
          <span class="p">),</span>
          <span class="na">weight</span><span class="p">:</span> <span class="dl">"</span><span class="s2">400</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">style</span><span class="p">:</span> <span class="dl">"</span><span class="s2">normal</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Zen Kaku Gothic New</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">data</span><span class="p">:</span> <span class="k">await</span> <span class="nf">readFile</span><span class="p">(</span>
            <span class="k">new</span> <span class="nc">URL</span><span class="p">(</span>
              <span class="dl">"</span><span class="s2">./assets/fonts/ZenKakuGothicNew-Regular.ttf</span><span class="dl">"</span><span class="p">,</span>
              <span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">url</span>
            <span class="p">)</span>
          <span class="p">),</span>
          <span class="na">weight</span><span class="p">:</span> <span class="dl">"</span><span class="s2">400</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">style</span><span class="p">:</span> <span class="dl">"</span><span class="s2">normal</span><span class="dl">"</span><span class="p">,</span>
        <span class="p">},</span>
      <span class="p">],</span>
      <span class="na">width</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span>
      <span class="na">height</span><span class="p">:</span> <span class="mi">630</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">);</span>

  <span class="kd">const</span> <span class="nx">resvg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Resvg</span><span class="p">(</span><span class="nx">svg</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">fitTo</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">mode</span><span class="p">:</span> <span class="dl">"</span><span class="s2">original</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">});</span>
  <span class="kd">const</span> <span class="nx">pngData</span> <span class="o">=</span> <span class="nx">resvg</span><span class="p">.</span><span class="nf">render</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">pngBuffer</span> <span class="o">=</span> <span class="nx">pngData</span><span class="p">.</span><span class="nf">asPng</span><span class="p">();</span>
  <span class="k">await</span> <span class="nf">writeFile</span><span class="p">(</span>
    <span class="k">new</span> <span class="nc">URL</span><span class="p">(</span><span class="s2">`./assets/img/og/</span><span class="p">${</span><span class="nx">slug</span><span class="p">}</span><span class="s2">.png`</span><span class="p">,</span> <span class="k">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">url</span><span class="p">),</span>
    <span class="nx">pngBuffer</span>
  <span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p><a href="https://blog.r74.tech/assets/img/post/2024-02-29/2024-02-29-generate-og.png" class="popup img-link shimmer"><img src="https://blog.r74.tech/assets/img/post/2024-02-29/2024-02-29-generate-og.png" alt="生成画像" loading="lazy"></a></p><h2 id="jekyll-側の対応"><span class="me-2">Jekyll 側の対応</span><a href="#jekyll-側の対応" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>このブログのテーマ側で、<code class="language-plaintext highlighter-rouge">jekyll-seo-tag</code>が使われているため、frontmatter に<code class="language-plaintext highlighter-rouge">image</code>を追加することで OG 画像を指定できる。ただし、画像を追加すると記事の初めに画像が表示されるため、<code class="language-plaintext highlighter-rouge">_layouts/post.html</code>を修正する必要がある。</p><p><a href="https://github.com/r74tech/diary/blob/276cbc75d503111e790e4fda6703b291a8ae874e/_layouts/post.html#L33-L49">該当コード</a></p><p>このブログでは、<code class="language-plaintext highlighter-rouge">show</code>を追加して OG 画像を表示するかどうかを指定できるようにした。</p><h2 id="参考文献"><span class="me-2">参考文献</span><a href="#参考文献" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://blog.berlysia.net/entry/2024-02-29-honox-og-image">HonoX で satori を使って OG イメージも SSG する</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/web/">web</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/front/" class="post-tag no-text-decoration">front</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 "><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/"> CC BY-SA 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OG%E7%94%BB%E5%83%8F%E3%82%92%E5%8B%95%E7%9A%84%E3%81%AB%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B%20-%20R74&url=https%3A%2F%2Fblog.r74tech.com%2Fposts%2F2024-02-29-generate-og%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OG%E7%94%BB%E5%83%8F%E3%82%92%E5%8B%95%E7%9A%84%E3%81%AB%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B%20-%20R74&u=https%3A%2F%2Fblog.r74tech.com%2Fposts%2F2024-02-29-generate-og%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fblog.r74tech.com%2Fposts%2F2024-02-29-generate-og%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="https://b.hatena.ne.jp/add?mode=confirm&url=https%3A%2F%2Fblog.r74tech.com%2Fposts%2F2024-02-29-generate-og%2F&title=OG%E7%94%BB%E5%83%8F%E3%82%92%E5%8B%95%E7%9A%84%E3%81%AB%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B%20-%20R74" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="はてなブックマーク" aria-label="はてなブックマーク"> <i class="fa-fw fab fa-hatena"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/2025-04-08-takumi/">セキュリティ診断AIエージェント「Takumi」世界最速体験会 参加レポート</a><li class="text-truncate lh-lg"> <a href="/posts/2025-03-23-crtp-certification-experience/">CRTP (Certified Red Team Professional) Certification Experience</a><li class="text-truncate lh-lg"> <a href="/posts/2024-12-19-aozora-duckdb/">DuckDBとCodeMirrorを使って青空文庫のデータを検索する</a><li class="text-truncate lh-lg"> <a href="/posts/2024-07-18-rust-quinn-test/">QuinnでQUICを試す</a><li class="text-truncate lh-lg"> <a href="/posts/2024-09-21-azasecjaws01/">[wip] とある海豹とSecurity-JAWS #01 Writeup</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/wip/">wip</a> <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">Active Directory</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">Security</a> <a class="post-tag btn btn-outline-primary" href="/tags/writeup/">writeup</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai/">AI</a> <a class="post-tag btn btn-outline-primary" href="/tags/crtp/">CRTP</a> <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">ctf</a> <a class="post-tag btn btn-outline-primary" href="/tags/django/">django</a> <a class="post-tag btn btn-outline-primary" href="/tags/duckdb/">duckdb</a> <a class="post-tag btn btn-outline-primary" href="/tags/front/">front</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/2024-12-19-aozora-duckdb/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1734534000" data-df="ll" > Dec 19, 2024 </time><h4 class="pt-0 my-2">DuckDBとCodeMirrorを使って青空文庫のデータを検索する</h4><div class="text-muted"><p> 脆弱エンジニアの Advent Calendar 2024 19日目の記事です。 謝辞 本プロジェクトは@voluntasさんのduckdb-wasm-parquetを参考にさせていただきました。この場を借りて感謝申し上げます。 ライセンス情報 (クリックで展開) This product includes software developed by @voluntas (duck...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"><div class="btn btn-outline-primary disabled" aria-label="Older"><p>-</p></div><a href="/posts/2024-03-06-breachingad/" class="btn btn-outline-primary" aria-label="Newer" ><p>[wip] Breaching Active Directory</p></a></nav><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'r74tech/diary', 'data-repo-id': 'R_kgDOLYxsXQ', 'data-category': 'Announcements', 'data-category-id': 'DIC_kwDOLYxsXc4Cf4fq', 'data-mapping': 'pathname', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': 'en', 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/r74tech">r74tech</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution-ShareAlike 4.0 (CC BY-SA 4.0) License by the author." >Some rights reserved.</span></p><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/wip/">wip</a> <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">Active Directory</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">Security</a> <a class="post-tag btn btn-outline-primary" href="/tags/writeup/">writeup</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai/">AI</a> <a class="post-tag btn btn-outline-primary" href="/tags/crtp/">CRTP</a> <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">ctf</a> <a class="post-tag btn btn-outline-primary" href="/tags/django/">django</a> <a class="post-tag btn btn-outline-primary" href="/tags/duckdb/">duckdb</a> <a class="post-tag btn btn-outline-primary" href="/tags/front/">front</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/ja.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-M25T2W3P17"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-M25T2W3P17'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
